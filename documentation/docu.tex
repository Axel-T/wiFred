\documentclass[11pt,a4paper]{scrartcl}

\parskip 0.5em plus 0.5em

\pagestyle{headings}

\usepackage{graphicx,hyperref}
\usepackage[tablegrid]{vhistory}

\date{\vhCurrentDate}
\author{\vhListAllAuthors}
\title{wiFred documentation -- Documentation for WiFi throttle with withrottle interface and wireless clock driver}

\begin{document}
\thispagestyle{empty}
\maketitle

\begin{abstract}

  This document describes the usage and configuration of the wiFred -- a very simple wireless throttle to connect to withrottle servers like JMRI -- and the wireless clock driver used to drive a simple wallclock to the timing of JMRIs FastClock system. It also contains schematics and BOMs for both devices as well as programming instructions and assembly tips, and also an overview of options for the server side of things.

The most recent version of this document can be found at:

\textit{https://github.com/newHeiko/wiFred/blob/master/documentation/docu.pdf} and

\textit{https://github.com/newHeiko/wiFred/blob/master/documentation/docu.tex}.

Skip section~\ref{background} about the background for the wiFred development if you are not interested in the why and more into the how.

\end{abstract}

\tableofcontents

\section{Background for wiFred development} \label{background}

As of the writing of this document, JMRI~\cite{jmri} has a long track record of offering a server for using smartphones as wireless model railroad throttles, along with apps like withrottle~\cite{withrottleApp}\footnote{withrottle is also the name JMRI uses for the protocol and the server.} and EngineDriver~\cite{EngineDriver}. This server will enable WiFi throttles to control locos any model railroading layout to which JMRI can build a connection~\cite{jmrihardwaresupport}. In addition, Digitrax~\cite{digitrax} and MRC~\cite{mrc} offer specific hardware solutions to enable the connection of the abovementioned smartphone apps to their DCC systems through a WiFi network.

The Fremo~\cite{fremo} is a European modular model railroading club whose unique requirements on it's DCC throttles led to the creation of the throttles FRED and FREDI~\cite{fred} -- a series of LocoNet\textregistered-throttles which started their life as hobbyist projects with large numbers in circulation but were also commercially available from Uhlenbrock~\cite{uhlenbrock}.

\subsection{Specification wishlist}

In modular railroading events, particularly of the Fremo-americaN-group~\cite{fremo}, some people have evaluated the smartphone throttle solutions and found them lacking a nice, haptical feedback. So a wishlist was compiled to define the requirements for a wireless throttle:
\begin{itemize}
\item Same form factor as the FRED~\cite{fred} with similar controls
\item Option to control at least two, better four locomotives for double/triple traction (similar to the double FRED)
\item Battery runtime of at least six hours
\item Exchangeable batteries, so when the battery runs down, they can be quickly exchanged for a charged set or cheap primary cells
\item Easy configuration, but not too easy to prevent operators from accidentally selecting other locomotives
\item As little change to the existing Fremo Loconet\textregistered\ network as possible
\item Use of withrottle protocol, so the server side of the communication can be assumed to work and does not have to be developed as well
\end{itemize}

\subsection{Wireless clock}

During the development of this wiFred another topic came up in the americaN group of the Fremo, namely wireless clocks with adjustable clock rate for Timetable \& Trainorder operations. Contrary to other Fremo groups, the americaN group standard does not call for any cabling for fast clocks and the group does not have the equipment for setting up a fast clock network, so first trails were done with regular Quartz clocks at 1:1 rate which had to be adjusted to timetable starting time every timetable morning. So a new solution was required, adding the following to the specification above:

\begin{itemize}
\item Battery runtime of at least eight hours to have some backup for long days
\item Able to control cheap Quartz clocks
\item Clock rate adjustable centrally in small increments in case the timetable planner has misjudged the capacity of the layout or operators
\item Re-use existing systems as much as possible -- in the case of the clock system, use JMRIs fast clock server
\end{itemize}

\section{wiFred Wireless throttle}

\subsection{Usage}

\subsection{Configuration}

\subsubsection{General configuration} \label{throttle_GeneralConf}

\subsubsection{Loco configuration}

\subsubsection{DCC function configuration}

\subsection{Hardware description}

\subsection{Programming instructions}

\section{Clock driver}

\subsection{Usage}

\subsection{Configuration}

For general configuration (WiFi etc.) see section~\ref{throttle_GeneralConf}, as it's the same.

\subsection{Hardware description}

\subsection{Programming instructions}

\section{Server setup with JMRI}

\begin{thebibliography}{99}
\bibitem{jmri}{JMRI: A Java Model Railroad Interface, \textit{http://www.jmri.org}}
\bibitem{jmrihardwaresupport}{JMRI: Hardware Support, \textit{http://www.jmri.org/help/en/html/hardware/index.shtml}}
\bibitem{withrottleApp}{WiThrottle, \textit{http://www.withrottle.com/html/home.html}}
\bibitem{EngineDriver}{Home \textbar\ EngineDriver, \textit{https://enginedriver.mstevetodd.com/}}
\bibitem{fremo}{Home - FREMO - Freundeskreis Europ\"aischer Modelleisenbahner e.V., \textit{https://www.fremo-net.eu/en/home/}}
\bibitem{fred}{Throttle, \textit{http://fremodcc.sourceforge.net/throttle/throttle.en.html}}
\bibitem{uhlenbrock}{Uhlenbrock \textbar\ FRED, der Handregler für die Intellibox, \textit{https://uhlenbrock.de/de\_DE/produkte/prodarch/I62AD172-001.htm!ArcEntryInfo=0004.41.I62AD172}}
\bibitem{mrc}{Prodigy WiFi, \textit{http://www.modelrectifier.com/Prodigy-WiFi-s/332.htm}}
\bibitem{digitrax}{LocoNet WiFi interface, \textit{http://www.digitrax.com/products/wireless/lnwi/}}
\end{thebibliography}

\begin{versionhistory}
  \vhEntry{0.1}{2018-05-24}{Heiko Rosemann}{Setup first document structure.}
\end{versionhistory}

\end{document}
